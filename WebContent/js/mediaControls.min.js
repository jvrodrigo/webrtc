var container;var canvas;var ctx;var videoControls;var progressBar;var chat;var chatUI;var chatList;var card;$(document).ready(function(){chat=$("#chat");videoControls=$("#videoControls");progressBar=$("#progressBar");chatUI=document.getElementById("chat");chatUI.style.opacity=1;chatList=$("#chatList");chat.draggable();chat.resizable();videoControls.draggable();$("#chatList",chatList.mouseover(function(b){chat.draggable("disable")}).mouseleave(function(b){chat.draggable("enable")}));$("#progressBar",progressBar.mouseover(function(b){videoControls.draggable("disable")}).mouseleave(function(b){videoControls.draggable("enable")})),container=document.getElementById("container");canvas=document.getElementById("canvasLocalVideo");ctx=canvas.getContext("2d");console.log(screen.width);console.log(screen.height);card=document.getElementById("card");card.style.width=screen.width;card.style.height=screen.height+" px";var a=document.getElementById("localVideo")});var opacity=1;var paso=0.2;function upOpacity(){if(opacity<1){chatUI.style.opacity=(Math.round((opacity+paso)*100)/100);opacity=(Math.round((opacity+paso)*100)/100)}}function downOpacity(){if(opacity>0.2){chatUI.style.opacity=(Math.round((opacity-paso)*100)/100);opacity=(Math.round((opacity-paso)*100)/100)}}function closeChat(){chatUI.style.display="none";document.getElementById("chatOn").style.display="none";document.getElementById("chatOff").style.display="block"}function openChat(){chatUI.style.display="inherit";document.getElementById("chatOn").style.display="block";document.getElementById("chatOff").style.display="none"}function takePicture(){if(localVideo!=null){var a=Math.floor(localVideo.clientWidth);var b=Math.floor(localVideo.clientHeight);canvas.width=a;canvas.height=b;ctx.drawImage(localVideo,0,0,a,b);document.getElementById("snapShot").src=canvas.toDataURL("image/png")}}document.addEventListener("fullscreenchange",function(){if(document.fullscreen){}else{document.getElementById("enterFullScreen").style.display="block";document.getElementById("exitFullScreen").style.display="none"}},false);document.addEventListener("mozfullscreenchange",function(){if(document.mozFullScreen){}else{document.getElementById("enterFullScreen").style.display="block";document.getElementById("exitFullScreen").style.display="none"}},false);document.addEventListener("webkitfullscreenchange",function(){if(document.webkitIsFullScreen){}else{document.getElementById("enterFullScreen").style.display="block";document.getElementById("exitFullScreen").style.display="none"}},false);document.addEventListener("msfullscreenchange",function(){if(document.msFullscreenElement){}else{document.getElementById("enterFullScreen").style.display="block";document.getElementById("exitFullScreen").style.display="none"}},false);function enterFullScreen(){console.log("Entrando en pantalla completa.");if(container.requestFullscreen){container.requestFullscreen()}else{if(container.mozRequestFullScreen){container.mozRequestFullScreen()}else{if(container.webkitRequestFullscreen){container.webkitRequestFullscreen()}else{if(container.msRequestFullscreen){container.msRequestFullscreen()}}}}document.getElementById("enterFullScreen").style.display="none";document.getElementById("exitFullScreen").style.display="block"}function exitFullScreen(){console.log("Saliendo de pantalla completa.");if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}}}}document.getElementById("enterFullScreen").style.display="block";document.getElementById("exitFullScreen").style.display="none"}function reCall(){location.reload()}var isAudioMuted;function toggleAudioMute(){if(localStream!=null){if(localStream.getAudioTracks().length===0){console.log("No local audio available.");return}if(isAudioMuted){var a;for(a=0;a<localStream.getAudioTracks().length;a++){localStream.getAudioTracks()[a].enabled=true}if(remoteStream!=null){for(a=0;a<remoteStream.getAudioTracks().length;a++){remoteStream.getAudioTracks()[a].enabled=true}}document.getElementById("mute").style.display="block";document.getElementById("unMute").style.display="none";console.log("Audio unmuted.")}else{for(a=0;a<localStream.getAudioTracks().length;a++){localStream.getAudioTracks()[a].enabled=false}if(remoteStream!=null){for(a=0;a<remoteStream.getAudioTracks().length;a++){remoteStream.getAudioTracks()[a].enabled=false}}document.getElementById("mute").style.display="none";document.getElementById("unMute").style.display="block";console.log("Audio muted.")}isAudioMuted=!isAudioMuted}}var recorder;var mRecordRTC=new MRecordRTC();mRecordRTC.mediaType={audio:true,video:true};var isRecording=false;function recordL(){if(started){document.getElementById("record").style.display="none";document.getElementById("stopRecord").style.display="block";mRecordRTC.addStream(remoteStream);mRecordRTC.startRecording()}else{if(localStream!=null){document.getElementById("record").style.display="none";document.getElementById("stopRecord").style.display="block";mRecordRTC.addStream(localStream);mRecordRTC.startRecording()}}}var fileName="record";function stopRecordL(){document.getElementById("record").style.display="block";document.getElementById("stopRecord").style.display="none";mRecordRTC.stopRecording(function(b,d){mRecordRTC.writeToDisk();mRecordRTC.save();var h=document.createElement("a");h.href=b;h.target="_blank";h.download="webrtc.webm";var g=document.createElement("div");g.className="chatSend";var a=document.createElement("div");var c=document.createElement("div");var f=document.createElement("div");a.className="chatSendLateral";c.className="chatSendLateralB";f.className="chatSendMessage";var e=document.createTextNode("Descargar Video");h.appendChild(e);f.appendChild(h);g.appendChild(a);g.appendChild(c);g.appendChild(f);document.getElementById("chatList").appendChild(g);window.setInterval(function(){var i=document.getElementById("chatList");i.scrollTop=i.scrollHeight},1000)})};